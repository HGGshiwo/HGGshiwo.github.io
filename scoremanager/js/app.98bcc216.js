(function(e){function t(t){for(var n,r,c=t[0],i=t[1],u=t[2],d=0,v=[];d<c.length;d++)r=c[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&v.push(o[r][0]),o[r]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);s&&s(t);while(v.length)v.shift()();return l.push.apply(l,u||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],n=!0,c=1;c<a.length;c++){var i=a[c];0!==o[i]&&(n=!1)}n&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},o={app:0},l=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=i;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},3228:function(e,t,a){"use strict";a("925b")},"56d7":function(e,t,a){"use strict";a.r(t);var n=a("7a23");function o(e,t,a,o,l,r){const c=Object(n["resolveComponent"])("ScoreHandler"),i=Object(n["resolveComponent"])("el-tab-pane"),u=Object(n["resolveComponent"])("el-tabs");return Object(n["openBlock"])(),Object(n["createBlock"])(u,{type:"border-card"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i,{label:"成绩处理"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c)]),_:1})]),_:1})}const l=Object(n["createTextVNode"])("使用说明"),r={class:"el-upload__tip"},c=Object(n["createTextVNode"])("下载文件");function i(e,t,a,o,i,u){const s=Object(n["resolveComponent"])("el-tag"),d=Object(n["resolveComponent"])("el-form-item"),v=Object(n["resolveComponent"])("el-col"),f=Object(n["resolveComponent"])("el-button"),p=Object(n["resolveComponent"])("el-row"),b=Object(n["resolveComponent"])("Check"),O=Object(n["resolveComponent"])("Plus"),j=Object(n["resolveComponent"])("el-icon"),h=Object(n["resolveComponent"])("el-upload");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createVNode"])(p,{style:{"marging-bottom":"20px"}},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(v,{span:4},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(d,{label:"成绩输入模式"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(s,{effect:"plain",size:"large"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(0===o.mode?"期中":-1===o.mode?"待检测":"期末"),1)]),_:1})]),_:1})]),_:1}),Object(n["createVNode"])(v,{span:3,push:15},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(f,{type:"text",onClick:o.openInst},{default:Object(n["withCtx"])(()=>[l]),_:1},8,["onClick"])]),_:1})]),_:1}),(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(["请上传钉钉模板","请上传成绩文件"],(e,t)=>Object(n["createVNode"])(h,{ref_for:!0,ref:"upload",key:e,limit:1,drag:"",class:"avatar-uploader","on-change":e=>{o.handleChange(e,t)},"on-remove":e=>{o.handleRemove(e,t)},"on-exceed":e=>{o.handleExceed(e[0],t)},style:{width:"80%","margin-left":"10%","margin-bottom":"10px"},"auto-upload":!1},{tip:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",r,Object(n["toDisplayString"])(o.uploadState[t].ok?o.uploadState[t].name:e),1)]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(j,{class:"avatar-uploader-icon"},{default:Object(n["withCtx"])(()=>[o.uploadState[t].ok?(Object(n["openBlock"])(),Object(n["createBlock"])(b,{key:0})):(Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:1}))]),_:2},1024)]),_:2},1032,["on-change","on-remove","on-exceed"])),64)),Object(n["createVNode"])(f,{loading:o.loading,type:"primary",onClick:o.handleClick},{default:Object(n["withCtx"])(()=>[c]),_:1},8,["loading","onClick"])],64)}a("907a"),a("3c5d"),a("fa9e"),a("77d9"),a("caad");var u=a("f6f2"),s=a("a1e9"),d=a("25ca"),v=a("6b59"),f=a("4a15");function p(e,t){t=t||"sheet1";var a={SheetNames:[t],Sheets:{}};a.Sheets[t]=e;var n={bookType:"xlsx",bookSST:!1,type:"binary"},o=Object(d["b"])(a,n),l=new Blob([r(o)],{type:"application/octet-stream"});function r(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!=e.length;++n)a[n]=255&e.charCodeAt(n);return t}return l}function b(e,t){"object"==typeof e&&e instanceof Blob&&(e=URL.createObjectURL(e));var a,n=document.createElement("a");n.href=e,n.download=t||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),n.dispatchEvent(a)}var O={components:{Plus:u["b"],Check:u["a"]},setup(){const e=Object(s["s"])(-1),t=Object(s["s"])(),a=Object(s["s"])(1),n=Object(s["s"])(!1);let o=[];const l=Object(s["s"])([{name:"",ok:!1,file:void 0},{name:"",ok:!1,file:void 0}]);let r=[];const c=(e,a)=>{!1!==w(e.raw)?(l.value[a].name=e.name,l.value[a].ok=!0,i(e,a)):t.value[a].clearFiles()},i=(t,a)=>{t.raw&&(t=t.raw);const o=new FileReader;o.onload=t=>{try{n.value=!0;const o=t.target.result,r=Object(d["a"])(o,{type:"binary"});0===a?l.value[a].file=r.Sheets[r.SheetNames[0]]:r.SheetNames.includes("年段")?(e.value=0,l.value[a].file=r.Sheets["年段"],console.log(r.Sheets["年段"])):(e.value=1,l.value[a].file=r.Sheets[r.SheetNames[0]]),n.value=!1}catch(o){return v["a"].alert("错误:"+o),n.value=!1,!1}},o.readAsBinaryString(t)},u=(t,a)=>{l.value[a].ok=!1,l.value[a].file=void 0,1===a&&(e.value=-1)},O=[{"学号":"A","语文":"F","数学":"G","英语":"H","物理":"I","化学":"J","生物":"N","政治":"K","历史":"L","地理":"M","技术":"O","外语":"","年级总分排名":"S","语文年级排名":"","数学年级排名":"","英语年级排名":"","物理年级排名":"","化学年级排名":"","生物年级排名":"","政治年级排名":"","历史年级排名":"","地理年级排名":"","技术年级排名":"","外语年级排名":""},{"学号":"A","语文":"F","数学":"J","英语":"N","物理":"R","化学":"V","生物":"Z","政治":"AD","历史":"AH","地理":"AL","技术":"AP","外语":"AT","年级总分排名":"CR","语文年级排名":"H","数学年级排名":"L","英语年级排名":"P","物理年级排名":"T","化学年级排名":"X","生物年级排名":"AB","政治年级排名":"AF","历史年级排名":"AJ","地理年级排名":"AN","技术年级排名":"AR","外语年级排名":"AV"}],j=(e,a)=>{w(e)&&(t.value[a].clearFiles(),e.uid=Object(f["a"])(),t.value[a].handleStart(e),l.value[a].name=e.name,i(e,a))},h=()=>{if(!l.value[0].ok)return void v["a"].alert("未输入钉钉模板");if(!l.value[1].ok)return void v["a"].alert("未输入学生成绩文件");if(1==n.value)return;o=[],n.value=!0;const t=l.value[0].file["B4"].v.replace(/[^0-9]+/g,""),a=Object.keys(l.value[0].file).filter(e=>e.match(/^[A-Z]+3$/)).map(t=>{const a=O[e.value];return{raw:t.replace(/[0-9]+/g,""),to:a[l.value[0].file[t].v]}}),c=Object.keys(l.value[0].file).filter(e=>"C3"!==e&&e.match(/C[0-9]+/)).map(e=>l.value[0].file[e].v);r=Object.keys(l.value[1].file).filter(t=>(!["C1","C2"].includes(t)||0!==e.value)&&((!["C1","C2","C3"].includes(t)||1!==e.value)&&t.match(/^C[0-9]+$/))).map(e=>l.value[1].file[e].v),new Promise((e,n)=>{c.forEach((e,n)=>{let r=m(t,e);-1!=r?a.forEach(e=>{if(!["B","C","O"].includes(e.raw)&&""!==e.to)if(-1==r)l.value[0].file[`${e.raw}${n+4}`]={s:"",v:"",t:""};else{let t=l.value[1].file[`${e.to}${r}`];t&&(l.value[0].file[`${e.raw}${n+4}`]={v:t.v,t:t.t,w:t.w})}}):o.push(e)}),e()}).then(()=>{n.value=!1;let e=l.value[0].name.split(".");v["a"].alert(o+"未参加考试.","提示",{confirmButtonText:"好的",callback:()=>{b(p(l.value[0].file,"成绩单模板1"),`${e[0]}-生成.${e[1]}`)}})})},m=(t,a)=>{for(var n=0;n<r.length;n++)if(r[n]===a){if(1===e.value&&t===l.value[1].file["D"+(n+4)].v)return n+4;if(0===e.value&&t==l.value[1].file["B"+(n+3)].v)return n+3}return-1},w=e=>"application/vnd.ms-excel"===e.type||(v["a"].alert("必须是excel类型的文件"),!1),C=()=>{Object(v["a"])({title:"使用说明",dangerouslyUseHTMLString:!0,message:'\n          <div>1. 从钉钉上下载模板文件<div>\n          <div>2. 上传钉钉模板文件和学生成绩文件<div>\n          <div>3. 点击下载文件</div>\n          <div>4. 将下载的文件上传到钉钉成绩录入。</div>\n         <a href="https://github.com/HGGshiwo/scoremanager">项目地址</a>'})};return{activePage:a,handleChange:c,handleRemove:u,handleExceed:j,uploadState:l,handleClick:h,loading:n,openInst:C,upload:t,mode:e}}},j=(a("f213"),a("3228"),a("6b0d")),h=a.n(j);const m=h()(O,[["render",i],["__scopeId","data-v-154b0ab6"]]);var w=m,C={name:"App",components:{ScoreHandler:w}};a("7197");const g=h()(C,[["render",o]]);var y=g,k=a("4d5f");a("7437");const x=Object(n["createApp"])(y);x.use(k["a"]),x.mount("#app")},"5e15":function(e,t,a){},7197:function(e,t,a){"use strict";a("850f")},"850f":function(e,t,a){},"925b":function(e,t,a){},f213:function(e,t,a){"use strict";a("5e15")}});
//# sourceMappingURL=app.98bcc216.js.map
(function(e){function t(t){for(var o,l,c=t[0],i=t[1],u=t[2],d=0,p=[];d<c.length;d++)l=c[d],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&p.push(a[l][0]),a[l]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);s&&s(t);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,c=1;c<n.length;c++){var i=n[c];0!==a[i]&&(o=!1)}o&&(r.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},a={app:0},r=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=i;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"3bb0":function(e,t,n){"use strict";n("bc42")},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("7a23");function a(e,t,n,a,r,l){const c=Object(o["resolveComponent"])("ScoreHandler"),i=Object(o["resolveComponent"])("el-tab-pane"),u=Object(o["resolveComponent"])("el-tabs");return Object(o["openBlock"])(),Object(o["createBlock"])(u,{type:"border-card"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(i,{label:"成绩处理"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c)]),_:1})]),_:1})}const r=Object(o["createTextVNode"])("使用说明"),l={class:"el-upload__tip"},c=Object(o["createTextVNode"])("下载文件");function i(e,t,n,a,i,u){const s=Object(o["resolveComponent"])("el-button"),d=Object(o["resolveComponent"])("Check"),p=Object(o["resolveComponent"])("Plus"),v=Object(o["resolveComponent"])("el-icon"),f=Object(o["resolveComponent"])("el-upload");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(s,{type:"text",onClick:a.openInst},{default:Object(o["withCtx"])(()=>[r]),_:1},8,["onClick"]),(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(["请上传钉钉模板","请上传成绩文件"],(e,t)=>Object(o["createVNode"])(f,{ref_for:!0,ref:"upload",key:e,limit:1,drag:"",class:"avatar-uploader","on-change":e=>{a.handleChange(e,t)},"on-remove":e=>{a.handleRemove(e,t)},"on-exceed":e=>{a.handleExceed(e[0],t)},style:{width:"80%","margin-left":"10%","margin-bottom":"10px"},"auto-upload":!1},{tip:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",l,Object(o["toDisplayString"])(a.uploadState[t].ok?a.uploadState[t].name:e),1)]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(v,{class:"avatar-uploader-icon"},{default:Object(o["withCtx"])(()=>[a.uploadState[t].ok?(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:0})):(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:1}))]),_:2},1024)]),_:2},1032,["on-change","on-remove","on-exceed"])),64)),Object(o["createVNode"])(s,{loading:a.loading,type:"primary",onClick:a.handleClick},{default:Object(o["withCtx"])(()=>[c]),_:1},8,["loading","onClick"])],64)}n("907a"),n("3c5d"),n("fa9e"),n("77d9"),n("caad");var u=n("f6f2"),s=n("a1e9"),d=n("25ca"),p=n("6b59"),v=n("4a15");function f(e,t){t=t||"sheet1";var n={SheetNames:[t],Sheets:{}};n.Sheets[t]=e;var o={bookType:"xlsx",bookSST:!1,type:"binary"},a=Object(d["b"])(n,o),r=new Blob([l(a)],{type:"application/octet-stream"});function l(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!=e.length;++o)n[o]=255&e.charCodeAt(o);return t}return console.log(1),r}function b(e,t){"object"==typeof e&&e instanceof Blob&&(e=URL.createObjectURL(e));var n,o=document.createElement("a");o.href=e,o.download=t||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),o.dispatchEvent(n),console.log(2)}var h={components:{Plus:u["b"],Check:u["a"]},setup(){const e=Object(s["s"])(),t=Object(s["s"])(1),n=Object(s["s"])(!1);let o=[];const a=Object(s["s"])([{name:"",ok:!1,file:void 0},{name:"",ok:!1,file:void 0}]);let r=[];const l=(e,t)=>{a.value[t].name=e.name,a.value[t].ok=!0,c(e,t)},c=(e,t)=>{e.raw&&(e=e.raw);const o=new FileReader;o.onload=e=>{try{n.value=!0;const o=e.target.result,r=Object(d["a"])(o,{type:"binary"});a.value[t].file=r.Sheets[r.SheetNames[0]],n.value=!1}catch(o){return p["a"].alert("错误:"+o),n.value=!1,!1}},o.readAsBinaryString(e)},i=(e,t)=>{a.value[t].ok=!1,a.value[t].file=void 0},u=(t,n)=>{e.value[n].clearFiles(),t.uid=Object(v["a"])(),e.value[n].handleStart(t),a.value[n].name=t.name,console.log(t),c(t,n)},h=()=>{if(!a.value[0].ok)return void p["a"].alert("未输入钉钉模板");if(!a.value[1].ok)return void p["a"].alert("未输入学生成绩文件");if(1==n.value)return;o=[],n.value=!0,console.log(a.value[0].file);const e=a.value[0].file["B4"].v.replace(/[^0-9]+/g,""),t=Object.keys(a.value[0].file).filter(e=>e.match(/^[A-Z]+3$/)).map(e=>{const t={"学号":"A","语文":"F","数学":"J","英语":"N","物理":"R","化学":"V","生物":"Z","政治":"AD","历史":"AH","地理":"AL","技术":"AP","外语":"AT","年级总分排名":"CR","语文年级排名":"H","数学年级排名":"L","英语年级排名":"P","物理年级排名":"T","化学年级排名":"X","生物年级排名":"AB","政治年级排名":"AF","历史年级排名":"AJ","地理年级排名":"AN","技术年级排名":"AR","外语年级排名":"AV"};return{raw:e.replace(/[0-9]+/g,""),to:t[a.value[0].file[e].v]}}),l=Object.keys(a.value[0].file).filter(e=>"C3"!==e&&e.match(/C[0-9]+/)).map(e=>a.value[0].file[e].v);r=Object.keys(a.value[1].file).filter(e=>!["C1","C2","C3"].includes(e)&&e.match(/^C[0-9]+$/)).map(e=>a.value[1].file[e].v),new Promise((n,r)=>{l.forEach((n,r)=>{console.log(r);let l=O(e,n);-1!=l?t.forEach(e=>{["B","C","O"].includes(e.raw)||(a.value[0].file[`${e.raw}${r+4}`]=-1==l?{s:"",v:"",t:""}:{...a.value[1].file[`${e.to}${l}`]})}):o.push(n)}),n()}).then(()=>{console.log(3),n.value=!1;let e=a.value[0].name.split(".");p["a"].alert(o+"未参加考试.","提示",{confirmButtonText:"好的",callback:()=>{b(f(a.value[0].file,"成绩单模板1"),`${e[0]}-生成.${e[1]}`)}})})},O=(e,t)=>{for(var n=0;n<r.length;n++)if(r[n]===t&&e===a.value[1].file["D"+(n+4)].v)return n+4;return-1},j=()=>{Object(p["a"])({title:"使用说明",dangerouslyUseHTMLString:!0,message:'\n          <div>1. 从钉钉上下载模板文件<div>\n          <div>2. 上传钉钉模板文件和学生成绩文件<div>\n          <div>3. 点击下载文件</div>\n          <div>4. 将下载的文件上传到钉钉成绩录入。</div>\n         <a href="https://github.com/HGGshiwo/scoremanager">项目地址</a>'})};return{activePage:t,handleChange:l,handleRemove:i,handleExceed:u,uploadState:a,handleClick:h,loading:n,openInst:j,upload:e}}},O=(n("c6cc"),n("3bb0"),n("6b0d")),j=n.n(O);const m=j()(h,[["render",i],["__scopeId","data-v-5a69d6b6"]]);var g=m,y={name:"App",components:{ScoreHandler:g}};n("7197");const k=j()(y,[["render",a]]);var w=k,C=n("4d5f");n("7437");const x=Object(o["createApp"])(w);x.use(C["a"]),x.mount("#app")},7197:function(e,t,n){"use strict";n("850f")},"850f":function(e,t,n){},bc42:function(e,t,n){},c6cc:function(e,t,n){"use strict";n("e0e0")},e0e0:function(e,t,n){}});
//# sourceMappingURL=app.22f147e0.js.map
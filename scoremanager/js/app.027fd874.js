(function(e){function t(t){for(var c,r,n=t[0],i=t[1],u=t[2],b=0,s=[];b<n.length;b++)r=n[b],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&s.push(o[r][0]),o[r]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c]);d&&d(t);while(s.length)s.shift()();return l.push.apply(l,u||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],c=!0,n=1;n<a.length;n++){var i=a[n];0!==o[i]&&(c=!1)}c&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var c={},o={app:0},l=[];function r(t){if(c[t])return c[t].exports;var a=c[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=c,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)r.d(a,c,function(t){return e[t]}.bind(null,c));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],i=n.push.bind(n);n.push=t,n=n.slice();for(var u=0;u<n.length;u++)t(n[u]);var d=i;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);var c=a("7a23");function o(e,t,a,o,l,r){const n=Object(c["resolveComponent"])("ScoreHandler"),i=Object(c["resolveComponent"])("el-tab-pane"),u=Object(c["resolveComponent"])("el-tabs");return Object(c["openBlock"])(),Object(c["createBlock"])(u,{type:"border-card"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(i,{label:"成绩处理"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(n)]),_:1})]),_:1})}const l=e=>(Object(c["pushScopeId"])("data-v-40df90b4"),e=e(),Object(c["popScopeId"])(),e),r=l(()=>Object(c["createElementVNode"])("p",null,[Object(c["createTextVNode"])(" 1. 从钉钉上下载模板文件"),Object(c["createElementVNode"])("br"),Object(c["createTextVNode"])(" 2. 上传钉钉模板文件和学生成绩文件"),Object(c["createElementVNode"])("br"),Object(c["createTextVNode"])(" 3. 点击下载文件"),Object(c["createElementVNode"])("br"),Object(c["createTextVNode"])(" 4. 将下载的文件上传到钉钉成绩录入。"),Object(c["createElementVNode"])("br"),Object(c["createTextVNode"])(" 5. 文件在本地处理，不会上传到服务器。"),Object(c["createElementVNode"])("br"),Object(c["createTextVNode"])(" 6. 模板根据输入的文件自动识别，支持以下格式 ")],-1)),n=Object(c["createTextVNode"])(" 映射关系: "),i=l(()=>Object(c["createElementVNode"])("a",{href:"https://github.com/HGGshiwo/scoremanager"},"项目地址",-1)),u={class:"dialog-footer"},d=Object(c["createTextVNode"])("确定"),b=Object(c["createTextVNode"])("使用说明"),s={class:"el-upload__tip"},p=Object(c["createTextVNode"])("下载文件");function O(e,t,a,o,l,O){const v=Object(c["resolveComponent"])("el-tag"),j=Object(c["resolveComponent"])("el-space"),f=Object(c["resolveComponent"])("el-card"),m=Object(c["resolveComponent"])("el-scrollbar"),h=Object(c["resolveComponent"])("el-button"),C=Object(c["resolveComponent"])("el-dialog"),w=Object(c["resolveComponent"])("el-form-item"),g=Object(c["resolveComponent"])("el-col"),y=Object(c["resolveComponent"])("el-row"),x=Object(c["resolveComponent"])("Check"),k=Object(c["resolveComponent"])("Plus"),N=Object(c["resolveComponent"])("el-icon"),V=Object(c["resolveComponent"])("el-upload");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createVNode"])(C,{modelValue:o.dialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>o.dialogVisible=e),title:"使用说明",center:""},{footer:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("span",u,[Object(c["createVNode"])(h,{type:"primary",onClick:t[0]||(t[0]=e=>o.dialogVisible=!1)},{default:Object(c["withCtx"])(()=>[d]),_:1})])]),default:Object(c["withCtx"])(()=>[r,Object(c["createVNode"])(m,{height:"200px"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(j,{direction:"vertical"},{default:Object(c["withCtx"])(()=>[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(o.modeList,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(f,{key:e,shadow:"never"},{header:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("span",null,Object(c["toDisplayString"])(`表格名称: ${e.sheetName} 班级位置: ${e.classColumn}${e.base}`),1)]),default:Object(c["withCtx"])(()=>[n,Object(c["createVNode"])(j,{wrap:""},{default:Object(c["withCtx"])(()=>[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.columnMap,(e,t)=>(Object(c["openBlock"])(),Object(c["createBlock"])(v,{key:e},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(`${e}(${t})`),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),i]),_:1},8,["modelValue"]),Object(c["createVNode"])(y,{style:{"marging-bottom":"20px"}},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(g,{span:4},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(w,{label:"成绩输入模式"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(v,{effect:"plain",size:"large"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(0===o.mode?"期中":-1===o.mode?"待检测":"期末"),1)]),_:1})]),_:1})]),_:1}),Object(c["createVNode"])(g,{span:3,push:15},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(h,{type:"text",onClick:t[2]||(t[2]=e=>o.dialogVisible=!0)},{default:Object(c["withCtx"])(()=>[b]),_:1})]),_:1})]),_:1}),(Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(["请上传钉钉模板","请上传成绩文件"],(e,t)=>Object(c["createVNode"])(V,{ref_for:!0,ref:"upload",key:e,limit:1,drag:"",class:"avatar-uploader","on-change":e=>{o.handleChange(e,t)},"on-remove":e=>{o.handleRemove(e,t)},"on-exceed":e=>{o.handleExceed(e[0],t)},style:{width:"80%","margin-left":"10%","margin-bottom":"10px"},"auto-upload":!1},{tip:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",s,Object(c["toDisplayString"])(o.uploadState[t].ok?o.uploadState[t].name:e),1)]),default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(N,{class:"avatar-uploader-icon"},{default:Object(c["withCtx"])(()=>[o.uploadState[t].ok?(Object(c["openBlock"])(),Object(c["createBlock"])(x,{key:0})):(Object(c["openBlock"])(),Object(c["createBlock"])(k,{key:1}))]),_:2},1024)]),_:2},1032,["on-change","on-remove","on-exceed"])),64)),Object(c["createVNode"])(h,{loading:o.loading,type:"primary",onClick:o.handleClick},{default:Object(c["withCtx"])(()=>[p]),_:1},8,["loading","onClick"])],64)}a("907a"),a("3c5d"),a("fa9e"),a("77d9"),a("caad"),a("d9e2");var v=a("f6f2"),j=a("a1e9"),f=a("25ca"),m=a("6b59"),h=a("4a15");function C(e,t){t=t||"sheet1";var a={SheetNames:[t],Sheets:{}};a.Sheets[t]=e;var c={bookType:"xlsx",bookSST:!1,type:"binary"},o=Object(f["b"])(a,c),l=new Blob([r(o)],{type:"application/octet-stream"});function r(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),c=0;c!=e.length;++c)a[c]=255&e.charCodeAt(c);return t}return l}function w(e,t){"object"==typeof e&&e instanceof Blob&&(e=URL.createObjectURL(e));var a,c=document.createElement("a");c.href=e,c.download=t||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),c.dispatchEvent(a)}var g={components:{Plus:v["b"],Check:v["a"]},setup(){const e=Object(j["s"])(!1),t=Object(j["s"])(-1),a=Object(j["s"])(),c=Object(j["s"])(1),o=Object(j["s"])(!1);let l=[];const r=Object(j["s"])([{name:"",ok:!1,file:void 0},{name:"",ok:!1,file:void 0}]);let n=[];const i=(e,t)=>{!1!==y(e.raw)?(r.value[t].name=e.name,r.value[t].ok=!0,b(e,t)):a.value[t].clearFiles()},u=e=>{try{t.value=-1;for(var c=0;c<p.value.length;c++)e.SheetNames.includes(p.value[c].sheetName)&&(t.value=c,console.log(p.value[c].sheetName,t.value));if(-1===t.value)throw Error("文件匹配失败");r.value[1].file=e.Sheets[p.value[t.value].sheetName]}catch(o){a.value[1].clearFiles(),m["a"].alert("读取成绩文件错误: "+o)}},d=e=>{try{r.value[0].file=e.Sheets[e.SheetNames[0]]}catch(t){a.value[0].clearFiles(),m["a"].alert("读取模板文件错误: "+t)}},b=(e,t)=>{e.raw&&(e=e.raw);const a=new FileReader;a.onload=e=>{o.value=!0;const a=e.target.result,c=Object(f["a"])(a,{type:"binary"});0==t?d(c):u(c),o.value=!1},a.readAsBinaryString(e)},s=(e,a)=>{r.value[a].ok=!1,r.value[a].file=void 0,1===a&&(t.value=-1)},p=Object(j["s"])([{columnMap:{"学号":"A","语文":"F","数学":"G","英语":"H","物理":"I","化学":"J","生物":"N","政治":"K","历史":"L","地理":"M","技术":"O","外语":"","年级总分排名":"S","语文年级排名":"","数学年级排名":"","英语年级排名":"","物理年级排名":"","化学年级排名":"","生物年级排名":"","政治年级排名":"","历史年级排名":"","地理年级排名":"","技术年级排名":"","外语年级排名":""},sheetName:"年段",base:3,classColumn:"B"},{columnMap:{"学号":"A","语文":"F","数学":"J","英语":"N","物理":"R","化学":"V","生物":"Z","政治":"AD","历史":"AH","地理":"AL","技术":"AP","外语":"AT","年级总分排名":"CR","语文年级排名":"H","数学年级排名":"L","英语年级排名":"P","物理年级排名":"T","化学年级排名":"X","生物年级排名":"AB","政治年级排名":"AF","历史年级排名":"AJ","地理年级排名":"AN","技术年级排名":"AR","外语年级排名":"AV"},sheetName:"学生成绩",base:4,classColumn:"D"}]),O=(e,t)=>{y(e)&&(a.value[t].clearFiles(),e.uid=Object(h["a"])(),a.value[t].handleStart(e),r.value[t].name=e.name,b(e,t))},v=()=>{if(!r.value[0].ok)return void m["a"].alert("未输入钉钉模板");if(!r.value[1].ok)return void m["a"].alert("未输入学生成绩文件");let e=-1,a=[],c=[];try{l=[],o.value=!0,e=r.value[0].file["B4"].v.replace(/[^0-9]+/g,""),a=Object.keys(r.value[0].file).filter(e=>e.match(/^[A-Z]+3$/)).map(e=>{const a=p.value[t.value].columnMap;return{raw:e.replace(/[0-9]+/g,""),to:a[r.value[0].file[e].v]}}),c=Object.keys(r.value[0].file).filter(e=>"C3"!==e&&e.match(/C[0-9]+/)).map(e=>r.value[0].file[e].v)}catch(i){return o.value=!1,void m["a"].alert("钉钉模板文件解析错误: "+i)}try{n=Object.keys(r.value[1].file).filter(e=>{for(var a=0;a<p.value[t.value].base;a++)if(e==="C"+a)return!1;return e.match(/^C[0-9]+$/)}).map(e=>r.value[1].file[e].v)}catch(i){o.value=!1,m["a"].alert("成绩文件解析错误: "+i)}try{new Promise((t,o)=>{c.forEach((t,c)=>{let o=g(e,t);-1!=o?a.forEach(e=>{if(["B","C","O"].includes(e.raw))return;if(""===e.to)return;if(-1==o)return;let t=r.value[1].file[`${e.to}${o}`];t&&(r.value[0].file[`${e.raw}${c+4}`]={v:t.v,t:t.t,w:t.w})}):l.push(t)}),t()}).then(()=>{o.value=!1;let e=r.value[0].name.split(".");m["a"].alert(l+"未参加考试.","提示",{confirmButtonText:"好的",callback:()=>{w(C(r.value[0].file,"成绩单模板1"),`${e[0]}-生成.${e[1]}`)}})})}catch(i){return o.value=!1,void m["a"].alert("表格填写错误: "+i)}},g=(e,a)=>{for(var c=0;c<n.length;c++){if(n[c]!==a)continue;let o=c+p.value[t.value].base,l=p.value[t.value].classColumn;if(e==r.value[1].file[`${l}${o}`].v)return o}return-1},y=e=>"application/vnd.ms-excel"===e.type||(m["a"].alert("必须是excel类型的文件"),!1);return{activePage:c,handleChange:i,handleRemove:s,handleExceed:O,uploadState:r,handleClick:v,loading:o,upload:a,mode:t,modeList:p,dialogVisible:e}}},y=(a("dd0e"),a("edc0"),a("6b0d")),x=a.n(y);const k=x()(g,[["render",O],["__scopeId","data-v-40df90b4"]]);var N=k,V={name:"App",components:{ScoreHandler:N}};a("7197");const S=x()(V,[["render",o]]);var _=S,B=a("4d5f");a("7437");const E=Object(c["createApp"])(_);E.use(B["a"]),E.mount("#app")},7197:function(e,t,a){"use strict";a("850f")},"850f":function(e,t,a){},"8bc2":function(e,t,a){},dd0e:function(e,t,a){"use strict";a("dd37")},dd37:function(e,t,a){},edc0:function(e,t,a){"use strict";a("8bc2")}});
//# sourceMappingURL=app.027fd874.js.map
(function(e){function t(t){for(var o,l,c=t[0],i=t[1],u=t[2],d=0,f=[];d<c.length;d++)l=c[d],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&f.push(a[l][0]),a[l]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);s&&s(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,c=1;c<n.length;c++){var i=n[c];0!==a[i]&&(o=!1)}o&&(r.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},a={app:0},r=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=i;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"2c1a":function(e,t,n){"use strict";n("f89b")},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("7a23");function a(e,t,n,a,r,l){const c=Object(o["resolveComponent"])("ScoreHandler"),i=Object(o["resolveComponent"])("el-tab-pane"),u=Object(o["resolveComponent"])("el-tabs");return Object(o["openBlock"])(),Object(o["createBlock"])(u,{type:"border-card"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(i,{label:"成绩处理"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c)]),_:1})]),_:1})}const r=Object(o["createTextVNode"])("使用说明"),l={class:"el-upload__tip"},c=Object(o["createTextVNode"])("下载文件");function i(e,t,n,a,i,u){const s=Object(o["resolveComponent"])("el-button"),d=Object(o["resolveComponent"])("Check"),f=Object(o["resolveComponent"])("Plus"),p=Object(o["resolveComponent"])("el-icon"),v=Object(o["resolveComponent"])("el-upload");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(s,{type:"text",onClick:a.openInst},{default:Object(o["withCtx"])(()=>[r]),_:1},8,["onClick"]),(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(["请上传钉钉模板","请上传成绩文件"],(e,t)=>Object(o["createVNode"])(v,{key:e,limit:1,drag:"",class:"avatar-uploader","on-change":e=>{a.handleChange(e,t)},"on-remove":e=>{a.handleRemove(e,t)},"on-exceed":e=>{a.handleExceed(e,t)},style:{width:"80%","margin-left":"10%","margin-bottom":"10px"},"auto-upload":!1},{tip:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",l,Object(o["toDisplayString"])(a.uploadState[t].ok?a.uploadState[t].name:e),1)]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{class:"avatar-uploader-icon"},{default:Object(o["withCtx"])(()=>[a.uploadState[t].ok?(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:0})):(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:1}))]),_:2},1024)]),_:2},1032,["on-change","on-remove","on-exceed"])),64)),Object(o["createVNode"])(s,{loading:a.loading,type:"primary",onClick:a.handleClick},{default:Object(o["withCtx"])(()=>[c]),_:1},8,["loading","onClick"])],64)}n("907a"),n("3c5d"),n("fa9e"),n("77d9"),n("caad");var u=n("f6f2"),s=n("a1e9"),d=n("25ca"),f=n("6b59");function p(e,t){t=t||"sheet1";var n={SheetNames:[t],Sheets:{}};n.Sheets[t]=e;var o={bookType:"xlsx",bookSST:!1,type:"binary"},a=Object(d["b"])(n,o),r=new Blob([l(a)],{type:"application/octet-stream"});function l(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!=e.length;++o)n[o]=255&e.charCodeAt(o);return t}return console.log(1),r}function v(e,t){"object"==typeof e&&e instanceof Blob&&(e=URL.createObjectURL(e));var n,o=document.createElement("a");o.href=e,o.download=t||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),o.dispatchEvent(n),console.log(2)}var b={components:{Plus:u["b"],Check:u["a"]},setup(){const e=Object(s["s"])(1),t=Object(s["s"])(!1);let n=[];const o=Object(s["s"])([{name:"",ok:!1,file:void 0},{name:"",ok:!1,file:void 0}]);let a=[];const r=(e,t)=>{o.value[t].name=e.name,o.value[t].ok=!0,l(e,t)},l=(e,n)=>{const a=new FileReader;a.onload=e=>{try{t.value=!0;const a=e.target.result,r=Object(d["a"])(a,{type:"binary"});o.value[n].file=r.Sheets[r.SheetNames[0]],t.value=!1}catch(a){return f["a"].alert("错误:"+a),t.value=!1,!1}},a.readAsBinaryString(e.raw)},c=(e,t)=>{o.value[t].ok=!1,o.value[t].file=void 0},i=(e,t)=>{o.value[t].file=e,o.value[t].name=e.name},u=()=>{if(!o.value[0].ok)return void f["a"].alert("未输入钉钉模板");if(!o.value[1].ok)return void f["a"].alert("未输入学生成绩文件");if(1==t.value)return;n=[],t.value=!0,console.log(o.value[0].file);const e=o.value[0].file["B4"].v.replace(/[^0-9]+/g,""),r=Object.keys(o.value[0].file).filter(e=>e.match(/^[A-Z]+3$/)).map(e=>{const t={"学号":"A","语文":"F","数学":"J","英语":"N","物理":"R","化学":"V","生物":"Z","政治":"AD","历史":"AH","地理":"AL","技术":"AP","外语":"AT","年级总分排名":"CR","语文年级排名":"H","数学年级排名":"L","英语年级排名":"P","物理年级排名":"T","化学年级排名":"X","生物年级排名":"AB","政治年级排名":"AF","历史年级排名":"AJ","地理年级排名":"AN","技术年级排名":"AR","外语年级排名":"AV"};return{raw:e.replace(/[0-9]+/g,""),to:t[o.value[0].file[e].v]}}),l=Object.keys(o.value[0].file).filter(e=>"C3"!==e&&e.match(/C[0-9]+/)).map(e=>o.value[0].file[e].v);a=Object.keys(o.value[1].file).filter(e=>!["C1","C2","C3"].includes(e)&&e.match(/^C[0-9]+$/)).map(e=>o.value[1].file[e].v),new Promise((t,a)=>{l.forEach((t,a)=>{console.log(a);let l=b(e,t);-1!=l?r.forEach(e=>{["B","C","O"].includes(e.raw)||(o.value[0].file[`${e.raw}${a+4}`]=-1==l?{s:"",v:"",t:""}:{...o.value[1].file[`${e.to}${l}`]})}):n.push(t)}),t()}).then(()=>{console.log(3),t.value=!1;let e=o.value[0].name.split(".");f["a"].alert(n+"未参加考试.","提示",{confirmButtonText:"好的",callback:()=>{v(p(o.value[0].file,"成绩单模板1"),`${e[0]}-生成.${e[1]}`)}})})},b=(e,t)=>{for(var n=0;n<a.length;n++)if(a[n]===t&&e===o.value[1].file["D"+(n+4)].v)return n+4;return-1},h=()=>{Object(f["a"])({title:"使用说明",dangerouslyUseHTMLString:!0,message:'\n          <div>1. 从钉钉上下载模板文件<div>\n          <div>2. 上传钉钉模板文件和学生成绩文件<div>\n          <div>3. 点击下载文件</div>\n          <div>4. 将下载的文件上传到钉钉成绩录入。</div>\n         <a href="https://github.com/HGGshiwo/scoremanager">项目地址</a>'})};return{activePage:e,handleChange:r,handleRemove:c,handleExceed:i,uploadState:o,handleClick:u,loading:t,openInst:h}}},h=(n("2c1a"),n("a06f"),n("6b0d")),O=n.n(h);const j=O()(b,[["render",i],["__scopeId","data-v-5514882a"]]);var m=j,g={name:"App",components:{ScoreHandler:m}};n("7197");const y=O()(g,[["render",a]]);var k=y,w=n("4d5f");n("7437");const C=Object(o["createApp"])(k);C.use(w["a"]),C.mount("#app")},7197:function(e,t,n){"use strict";n("850f")},"850f":function(e,t,n){},a06f:function(e,t,n){"use strict";n("d456")},d456:function(e,t,n){},f89b:function(e,t,n){}});
//# sourceMappingURL=app.656ac6dd.js.map